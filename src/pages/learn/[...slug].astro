---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const lessons = await getCollection('learn');
  return lessons.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const { title, description, githubPath, colabUrl } = entry.data;
const githubBase = 'https://github.com/your-org';
const githubFull = githubPath ? `${githubBase}/${githubPath}` : null;
---
<BaseLayout title={title} description={description || title}>
  <article class="lesson">
    <header>
      <h1>{title}</h1>
      <div class="links">
        {githubFull && (
          <a href={githubFull} target="_blank" rel="noopener" class="btn-link">ดูโค้ดบน GitHub</a>
        )}
        {colabUrl && (
          <a href={colabUrl} target="_blank" rel="noopener" class="btn-link colab">Open in Colab</a>
        )}
      </div>
    </header>
    <Content />
    <footer class="links">
      {githubFull && <a href={githubFull} target="_blank" rel="noopener">ตัวอย่างโค้ด (GitHub)</a>}
      {colabUrl && <a href={colabUrl} target="_blank" rel="noopener">รันบน Google Colab</a>}
    </footer>
  </article>
</BaseLayout>

<style>
  .lesson header { margin-bottom: 1.5rem; }
  .lesson h1 { margin: 0 0 0.5rem; }
  .links { display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 0.5rem; }
  .btn-link { padding: 0.4rem 0.8rem; background: var(--surface); border: 1px solid rgba(255,255,255,0.15); border-radius: 6px; font-size: 0.9rem; }
  .btn-link:hover { border-color: var(--accent); text-decoration: none; }
  .btn-link.colab { background: #f9ab00; color: #000; border-color: #f9ab00; }
  .btn-link.colab:hover { filter: brightness(1.1); text-decoration: none; }
  .lesson footer { margin-top: 2rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.06); color: var(--muted); font-size: 0.9rem; }
  .lesson :global(h2) { margin-top: 1.5rem; font-size: 1.25rem; }
  .lesson :global(ul), .lesson :global(ol) { padding-left: 1.5rem; }
</style>
